(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,94179,e=>{"use strict";var t=e.i(43476),r=e.i(91918),s=e.i(25913),i=e.i(47163);let a=(0,s.cva)("inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground"}},defaultVariants:{variant:"default"}});function n({className:e,variant:s,asChild:n=!1,...d}){let o=n?r.Slot:"span";return(0,t.jsx)(o,{"data-slot":"badge",className:(0,i.cn)(a({variant:s}),e),...d})}e.s(["Badge",()=>n])},78784,78745,e=>{"use strict";let t=(0,e.i(75254).default)("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);e.s(["default",()=>t],78745),e.s(["CheckIcon",()=>t],78784)},35804,e=>{"use strict";var t=e.i(71645),r=e.i(34620);function s(e){let[s,i]=t.useState(void 0);return(0,r.useLayoutEffect)(()=>{if(e){i({width:e.offsetWidth,height:e.offsetHeight});let t=new ResizeObserver(t=>{let r,s;if(!Array.isArray(t)||!t.length)return;let a=t[0];if("borderBoxSize"in a){let e=a.borderBoxSize,t=Array.isArray(e)?e[0]:e;r=t.inlineSize,s=t.blockSize}else r=e.offsetWidth,s=e.offsetHeight;i({width:r,height:s})});return t.observe(e,{box:"border-box"}),()=>t.unobserve(e)}i(void 0)},[e]),s}e.s(["useSize",()=>s])},31278,e=>{"use strict";let t=(0,e.i(75254).default)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);e.s(["Loader2",()=>t],31278)},23750,e=>{"use strict";var t=e.i(43476),r=e.i(47163);function s({className:e,type:s,...i}){return(0,t.jsx)("input",{type:s,"data-slot":"input",className:(0,r.cn)("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",e),...i})}e.s(["Input",()=>s])},10708,e=>{"use strict";var t=e.i(43476),r=e.i(71645),s=e.i(48425),i=r.forwardRef((e,r)=>(0,t.jsx)(s.Primitive.label,{...e,ref:r,onMouseDown:t=>{t.target.closest("button, input, select, textarea")||(e.onMouseDown?.(t),!t.defaultPrevented&&t.detail>1&&t.preventDefault())}}));i.displayName="Label";var a=e.i(47163);function n({className:e,...r}){return(0,t.jsx)(i,{"data-slot":"label",className:(0,a.cn)("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",e),...r})}e.s(["Label",()=>n],10708)},84762,e=>{"use strict";var t=e.i(43476),r=e.i(47163);function s({className:e,...s}){return(0,t.jsx)("textarea",{"data-slot":"textarea",className:(0,r.cn)("border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),...s})}e.s(["Textarea",()=>s])},70065,e=>{"use strict";var t=e.i(43476),r=e.i(47163);function s({className:e,...s}){return(0,t.jsx)("div",{"data-slot":"card",className:(0,r.cn)("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",e),...s})}function i({className:e,...s}){return(0,t.jsx)("div",{"data-slot":"card-header",className:(0,r.cn)("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-2 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",e),...s})}function a({className:e,...s}){return(0,t.jsx)("div",{"data-slot":"card-title",className:(0,r.cn)("leading-none font-semibold",e),...s})}function n({className:e,...s}){return(0,t.jsx)("div",{"data-slot":"card-description",className:(0,r.cn)("text-muted-foreground text-sm",e),...s})}function d({className:e,...s}){return(0,t.jsx)("div",{"data-slot":"card-content",className:(0,r.cn)("px-6",e),...s})}e.s(["Card",()=>s,"CardContent",()=>d,"CardDescription",()=>n,"CardHeader",()=>i,"CardTitle",()=>a])},99682,e=>{"use strict";var t=e.i(71645);function r(e){let r=t.useRef({value:e,previous:e});return t.useMemo(()=>(r.current.value!==e&&(r.current.previous=r.current.value,r.current.value=e),r.current.previous),[e])}e.s(["usePrevious",()=>r])},63209,e=>{"use strict";let t=(0,e.i(75254).default)("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);e.s(["AlertCircle",()=>t],63209)},73884,e=>{"use strict";let t=(0,e.i(75254).default)("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);e.s(["XCircle",()=>t],73884)},25959,e=>{"use strict";var t=e.i(43476),r=e.i(71645),s=e.i(20783),i=e.i(30030),a=e.i(81140),n=e.i(69340),d=e.i(99682),o=e.i(35804),l=e.i(96626),c=e.i(48425),u="Checkbox",[x,h]=(0,i.createContextScope)(u),[m,f]=x(u),p=r.forwardRef((e,i)=>{let{__scopeCheckbox:d,name:o,checked:l,defaultChecked:u,required:x,disabled:h,value:f="on",onCheckedChange:p,form:v,...g}=e,[N,k]=r.useState(null),w=(0,s.useComposedRefs)(i,e=>k(e)),C=r.useRef(!1),S=!N||v||!!N.closest("form"),[T=!1,P]=(0,n.useControllableState)({prop:l,defaultProp:u,onChange:p}),A=r.useRef(T);return r.useEffect(()=>{let e=N?.form;if(e){let t=()=>P(A.current);return e.addEventListener("reset",t),()=>e.removeEventListener("reset",t)}},[N,P]),(0,t.jsxs)(m,{scope:d,state:T,disabled:h,children:[(0,t.jsx)(c.Primitive.button,{type:"button",role:"checkbox","aria-checked":j(T)?"mixed":T,"aria-required":x,"data-state":y(T),"data-disabled":h?"":void 0,disabled:h,value:f,...g,ref:w,onKeyDown:(0,a.composeEventHandlers)(e.onKeyDown,e=>{"Enter"===e.key&&e.preventDefault()}),onClick:(0,a.composeEventHandlers)(e.onClick,e=>{P(e=>!!j(e)||!e),S&&(C.current=e.isPropagationStopped(),C.current||e.stopPropagation())})}),S&&(0,t.jsx)(b,{control:N,bubbles:!C.current,name:o,value:f,checked:T,required:x,disabled:h,form:v,style:{transform:"translateX(-100%)"},defaultChecked:!j(u)&&u})]})});p.displayName=u;var v="CheckboxIndicator",g=r.forwardRef((e,r)=>{let{__scopeCheckbox:s,forceMount:i,...a}=e,n=f(v,s);return(0,t.jsx)(l.Presence,{present:i||j(n.state)||!0===n.state,children:(0,t.jsx)(c.Primitive.span,{"data-state":y(n.state),"data-disabled":n.disabled?"":void 0,...a,ref:r,style:{pointerEvents:"none",...e.style}})})});g.displayName=v;var b=e=>{let{control:s,checked:i,bubbles:a=!0,defaultChecked:n,...l}=e,c=r.useRef(null),u=(0,d.usePrevious)(i),x=(0,o.useSize)(s);r.useEffect(()=>{let e=c.current,t=Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,"checked").set;if(u!==i&&t){let r=new Event("click",{bubbles:a});e.indeterminate=j(i),t.call(e,!j(i)&&i),e.dispatchEvent(r)}},[u,i,a]);let h=r.useRef(!j(i)&&i);return(0,t.jsx)("input",{type:"checkbox","aria-hidden":!0,defaultChecked:n??h.current,...l,tabIndex:-1,ref:c,style:{...e.style,...x,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function j(e){return"indeterminate"===e}function y(e){return j(e)?"indeterminate":e?"checked":"unchecked"}var N=e.i(78784),k=e.i(47163);function w({className:e,...r}){return(0,t.jsx)(p,{"data-slot":"checkbox",className:(0,k.cn)("peer border-input dark:bg-input/30 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground dark:data-[state=checked]:bg-primary data-[state=checked]:border-primary focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive size-4 shrink-0 rounded-[4px] border shadow-xs transition-shadow outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",e),...r,children:(0,t.jsx)(g,{"data-slot":"checkbox-indicator",className:"flex items-center justify-center text-current transition-none",children:(0,t.jsx)(N.CheckIcon,{className:"size-3.5"})})})}e.s(["Checkbox",()=>w],25959)},42697,e=>{"use strict";var t=e.i(43476),r=e.i(71645),s=e.i(70065),i=e.i(23750),a=e.i(67881),n=e.i(10708),d=e.i(84762),o=e.i(25959),l=e.i(94179),c=e.i(31278),u=e.i(14764),x=e.i(61911),h=e.i(63209),m=e.i(95468),f=e.i(73884),p=e.i(20682);let v="http://192.168.1.35:5000";function g(){let{toast:e}=(0,p.useToast)(),[g,b]=(0,r.useState)(""),[j,y]=(0,r.useState)(""),[N,k]=(0,r.useState)(!0),[w,C]=(0,r.useState)([]),[S,T]=(0,r.useState)([]),[P,A]=(0,r.useState)(!0),[E,z]=(0,r.useState)(!1),[L,_]=(0,r.useState)(""),[D,R]=(0,r.useState)(null);(0,r.useEffect)(()=>{B()},[]);let B=async()=>{try{A(!0),_("");let e=localStorage.getItem("adminToken");if(!e)return void _("Not authenticated");let t=await fetch(`${v}/api/push-notifications/admin/vendors`,{headers:{Authorization:`Bearer ${e}`}}),r=await t.json();if(!t.ok||!r.success)return void _(r.message||"Failed to load vendors");T(r.data.vendors||[])}catch(e){console.error("Error fetching vendors:",e),_("Network error. Please try again.")}finally{A(!1)}},I=async t=>{if(t.preventDefault(),_(""),R(null),!g.trim()||!j.trim())return void _("Title and message are required");if(!N&&0===w.length)return void _("Please select at least one vendor or select 'Send to all vendors'");try{z(!0);let t=localStorage.getItem("adminToken");if(!t)return void _("Not authenticated");let r="general",s=g.toLowerCase();s.includes("new order")||s.includes("order available")?r="new_order_available":s.includes("order placed")?r="order_placed":s.includes("order accepted")?r="order_accepted":s.includes("order shipped")?r="order_shipped":s.includes("order delivered")&&(r="order_delivered");let i={title:g.trim(),body:j.trim(),data:{type:r}};N?i.sendToAll=!0:i.vendorIds=w;let a=await fetch(`${v}/api/push-notifications/admin/send`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`},body:JSON.stringify(i)}),n=await a.json();if(!a.ok||!n.success){_(n.message||"Failed to send push notification"),e({title:"Error",description:n.message||"Failed to send push notification",variant:"destructive"});return}R({success:!0,sent:n.sent||0,failed:n.failed||0,total:n.total||0,vendorsCount:n.vendorsCount||0,message:n.message||"Notification sent successfully"}),e({title:"Success",description:n.message||"Push notification sent successfully"}),b(""),y(""),C([]),k(!0),B()}catch(t){console.error("Error sending push notification:",t),_("Network error. Please try again."),e({title:"Error",description:"Network error. Please try again.",variant:"destructive"})}finally{z(!1)}},F=S.filter(e=>e.hasTokens&&e.isActive),H=S.filter(e=>!e.hasTokens||!e.isActive);return(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-2xl sm:text-3xl font-bold text-foreground",children:"Send Push Notifications"}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground mt-1",children:"Send push notifications to vendor app users"})]}),D&&(0,t.jsx)(s.Card,{className:D.failed>0?"border-orange-200 bg-orange-50/50":"border-green-200 bg-green-50/50",children:(0,t.jsx)(s.CardContent,{className:"pt-6",children:(0,t.jsxs)("div",{className:"flex items-start gap-3",children:[0===D.failed?(0,t.jsx)(m.CheckCircle2,{className:"h-5 w-5 text-green-600 mt-0.5"}):(0,t.jsx)(h.AlertCircle,{className:"h-5 w-5 text-orange-600 mt-0.5"}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("p",{className:"font-medium text-sm",children:D.message}),(0,t.jsxs)("div",{className:"mt-2 flex flex-wrap gap-4 text-sm text-muted-foreground",children:[(0,t.jsxs)("span",{children:[(0,t.jsx)("strong",{className:"text-green-600",children:D.sent})," sent"]}),D.failed>0&&(0,t.jsxs)("span",{children:[(0,t.jsx)("strong",{className:"text-red-600",children:D.failed})," failed"]}),(0,t.jsxs)("span",{children:[(0,t.jsx)("strong",{children:D.vendorsCount})," vendor(s)"]}),(0,t.jsxs)("span",{children:[(0,t.jsx)("strong",{children:D.total})," device(s)"]})]})]})]})})}),(0,t.jsxs)("div",{className:"grid gap-6 md:grid-cols-2",children:[(0,t.jsxs)(s.Card,{children:[(0,t.jsxs)(s.CardHeader,{children:[(0,t.jsx)(s.CardTitle,{children:"Notification Details"}),(0,t.jsx)(s.CardDescription,{children:"Compose your push notification message"})]}),(0,t.jsx)(s.CardContent,{children:(0,t.jsxs)("form",{onSubmit:I,className:"space-y-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(n.Label,{htmlFor:"title",children:"Title *"}),(0,t.jsx)(i.Input,{id:"title",placeholder:"e.g., New Order Received",value:g,onChange:e=>b(e.target.value),maxLength:100,required:!0}),(0,t.jsxs)("p",{className:"text-xs text-muted-foreground",children:[g.length,"/100 characters"]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(n.Label,{htmlFor:"body",children:"Message *"}),(0,t.jsx)(d.Textarea,{id:"body",placeholder:"e.g., You have received a new order. Please check your orders page.",value:j,onChange:e=>y(e.target.value),rows:4,maxLength:500,required:!0}),(0,t.jsxs)("p",{className:"text-xs text-muted-foreground",children:[j.length,"/500 characters"]})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-2 pt-2",children:[(0,t.jsx)(o.Checkbox,{id:"sendToAll",checked:N,onCheckedChange:e=>{k(e),e&&C([])}}),(0,t.jsx)(n.Label,{htmlFor:"sendToAll",className:"font-normal cursor-pointer",children:"Send to all vendors with push tokens"})]}),L&&(0,t.jsx)("div",{className:"rounded-md bg-destructive/10 border border-destructive/20 p-3",children:(0,t.jsxs)("div",{className:"flex items-start gap-2",children:[(0,t.jsx)(f.XCircle,{className:"h-4 w-4 text-destructive mt-0.5"}),(0,t.jsx)("p",{className:"text-sm text-destructive",children:L})]})}),(0,t.jsx)(a.Button,{type:"submit",className:"w-full",disabled:E||P,children:E?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(c.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}),"Sending..."]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(u.Send,{className:"mr-2 h-4 w-4"}),"Send Notification"]})})]})})]}),(0,t.jsxs)(s.Card,{children:[(0,t.jsxs)(s.CardHeader,{children:[(0,t.jsx)(s.CardTitle,{children:"Select Vendors"}),(0,t.jsx)(s.CardDescription,{children:"Choose specific vendors to send notifications to"})]}),(0,t.jsx)(s.CardContent,{children:P?(0,t.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,t.jsx)(c.Loader2,{className:"h-8 w-8 animate-spin text-primary"})}):(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("p",{className:"text-sm text-muted-foreground",children:[F.length," vendor(s) with push tokens"]}),!N&&F.length>0&&(0,t.jsx)(a.Button,{type:"button",variant:"outline",size:"sm",onClick:()=>{let e=S.filter(e=>e.hasTokens&&e.isActive);w.length===e.length?C([]):C(e.map(e=>e._id))},children:w.length===F.length?"Deselect All":"Select All"})]}),N?(0,t.jsxs)("div",{className:"rounded-md bg-muted p-4 text-center",children:[(0,t.jsx)(x.Users,{className:"h-8 w-8 mx-auto mb-2 text-muted-foreground"}),(0,t.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Notification will be sent to all ",F.length," vendor(s) with push tokens"]})]}):(0,t.jsx)("div",{className:"space-y-2 max-h-[400px] overflow-y-auto",children:0===F.length?(0,t.jsx)("div",{className:"text-center py-8 text-sm text-muted-foreground",children:"No vendors with push tokens found"}):F.map(e=>(0,t.jsxs)("div",{className:"flex items-center space-x-3 p-3 rounded-md border hover:bg-muted/50",children:[(0,t.jsx)(o.Checkbox,{id:e._id,checked:w.includes(e._id),onCheckedChange:()=>{var t;return t=e._id,void(w.includes(t)?C(w.filter(e=>e!==t)):C([...w,t]))},disabled:N}),(0,t.jsx)(n.Label,{htmlFor:e._id,className:"flex-1 cursor-pointer font-normal",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-medium text-sm",children:e.name||e.vendorName||"N/A"}),(0,t.jsxs)("p",{className:"text-xs text-muted-foreground",children:[e.mobile," â€¢ ",e.email||"No email"]})]}),(0,t.jsxs)(l.Badge,{variant:"secondary",className:"ml-2",children:[e.tokenCount," token",1!==e.tokenCount?"s":""]})]})})]},e._id))}),H.length>0&&(0,t.jsx)("div",{className:"pt-4 border-t",children:(0,t.jsxs)("p",{className:"text-xs text-muted-foreground mb-2",children:[H.length," vendor(s) without push tokens (will not receive notifications)"]})})]})})]})]})]})}e.s(["AdminPushNotifications",()=>g])}]);