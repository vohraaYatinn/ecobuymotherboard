(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,31439,e=>{"use strict";e.i(47167);var s=e.i(43476),t=e.i(71645),a=e.i(22016),r=e.i(70065),n=e.i(23750),l=e.i(67881),d=e.i(94179),i=e.i(62870),c=e.i(31278),o=e.i(55436),m=e.i(86536),u=e.i(75254);let h=(0,u.default)("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);var x=e.i(40160),g=e.i(73375),p=e.i(63059);let j=(0,u.default)("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);var f=e.i(23945),N=e.i(27365),y=e.i(27612),b=e.i(67240),v=e.i(69638),S=e.i(73884),w=e.i(47627),C=e.i(25959),T=e.i(30374),R=e.i(10708),I=e.i(84762),A=e.i(81947);let k="http://192.168.1.43:5000",B=e=>{switch(e.toLowerCase()){case"pending":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"confirmed":case"processing":case"return_picked_up":return"bg-blue-100 text-blue-800 border-blue-200";case"shipped":return"bg-purple-100 text-purple-800 border-purple-200";case"delivered":case"return_accepted":return"bg-green-100 text-green-800 border-green-200";case"cancelled":case"return_rejected":return"bg-red-100 text-red-800 border-red-200";case"return_requested":return"bg-orange-100 text-orange-800 border-orange-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}},D=e=>e.split("-").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" "),q=e=>{if(!e)return"bg-gray-100 text-gray-800 border-gray-200";switch(e.toLowerCase()){case"pending":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"booked":return"bg-blue-100 text-blue-800 border-blue-200";case"in_transit":return"bg-purple-100 text-purple-800 border-purple-200";case"out_for_delivery":return"bg-orange-100 text-orange-800 border-orange-200";case"delivered":return"bg-green-100 text-green-800 border-green-200";case"rto":case"failed":return"bg-red-100 text-red-800 border-red-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}},P=e=>e?e.split("_").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" "):"Not Set",$=e=>{if(!e)return"bg-gray-100 text-gray-800 border-gray-200";switch(e.toLowerCase()){case"pending":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"processing":return"bg-blue-100 text-blue-800 border-blue-200";case"completed":return"bg-green-100 text-green-800 border-green-200";case"failed":return"bg-red-100 text-red-800 border-red-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}},_=e=>e?e.charAt(0).toUpperCase()+e.slice(1):"N/A";function L(){let[e,u]=(0,t.useState)([]),[L,V]=(0,t.useState)(!0),[O,F]=(0,t.useState)(""),[M,U]=(0,t.useState)("all"),[E,z]=(0,t.useState)("all"),[H,J]=(0,t.useState)("all"),[W,K]=(0,t.useState)("all"),[Q,X]=(0,t.useState)("all"),[G,Y]=(0,t.useState)(1),[Z,ee]=(0,t.useState)({page:1,limit:10,total:0,pages:0}),[es,et]=(0,t.useState)(null),[ea,er]=(0,t.useState)(!1),[en,el]=(0,t.useState)(!1),[ed,ei]=(0,t.useState)(null),[ec,eo]=(0,t.useState)([]),[em,eu]=(0,t.useState)(!1),[eh,ex]=(0,t.useState)(""),[eg,ep]=(0,t.useState)({status:""}),[ej,ef]=(0,t.useState)(!1),[eN,ey]=(0,t.useState)([]),[eb,ev]=(0,t.useState)(!1),[eS,ew]=(0,t.useState)(!1),[eC,eT]=(0,t.useState)(!1),[eR,eI]=(0,t.useState)(null),[eA,ek]=(0,t.useState)(!1),[eB,eD]=(0,t.useState)("");(0,t.useEffect)(()=>{eq()},[G,M,E,H,W,Q]),(0,t.useEffect)(()=>{ey([])},[e]),(0,t.useEffect)(()=>{e$()},[]);let eq=async()=>{try{V(!0);let e=localStorage.getItem("adminToken");if(!e)return;let s=new URLSearchParams({page:G.toString(),limit:"10",sortBy:"createdAt",sortOrder:"desc",...O&&{search:O},..."all"!==M&&{status:M},..."all"!==E&&{paymentMethod:E},..."all"!==H&&{paymentStatus:H},..."all"!==W&&{vendorId:W},..."all"!==Q&&{assignmentMode:Q}}),t=await fetch(`${k}/api/admin/orders?${s}`,{headers:{Authorization:`Bearer ${e}`}});if(!t.ok)throw Error("Failed to fetch orders");let a=await t.json();a.success&&(u(a.data),ee(a.pagination))}catch(e){console.error("Error fetching orders:",e)}finally{V(!1)}},eP=()=>{Y(1),eq()},e$=async()=>{try{eu(!0);let e=await fetch(`${k}/api/vendors?status=approved&limit=100`),s=await e.json();s.success&&eo(s.data)}catch(e){console.error("Error fetching vendors:",e)}finally{eu(!1)}},e_=async()=>{if(ed)try{et(ed._id);let e=localStorage.getItem("adminToken");if(!e)return;let s=await fetch(`${k}/api/admin/orders/${ed._id}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify({status:eg.status})}),t=await s.json();t.success?(er(!1),ei(null),ep({status:""}),eq()):alert(t.message||"Failed to update order")}catch(e){console.error("Error updating order:",e),alert("Network error. Please try again.")}finally{et(null)}},eL=async()=>{if(ed)try{et(ed._id);let e=localStorage.getItem("adminToken");if(!e)return;let s=await fetch(`${k}/api/admin/orders/${ed._id}/assign-vendor`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify({vendorId:"none"===eh?null:eh})}),t=await s.json();t.success?(el(!1),ei(null),ex(""),eq()):alert(t.message||"Failed to assign vendor")}catch(e){console.error("Error assigning vendor:",e),alert("Network error. Please try again.")}finally{et(null)}},eV=e=>{ei(e),ex(("object"==typeof e.vendorId&&null!==e.vendorId?e.vendorId._id:null)||"none"),el(!0)},eO=e=>{eN.includes(e)?ey(eN.filter(s=>s!==e)):ey([...eN,e])},eF=()=>{eN.length===e.length?ey([]):ey(e.map(e=>e._id))},eM=async()=>{if(0===eN.length)return void alert("Please select at least one order to delete");try{ev(!0);let e=localStorage.getItem("adminToken");if(!e)return void alert("Please login again");let s=await fetch(`${k}/api/admin/orders/bulk-delete`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify({orderIds:eN})}),t=await s.json();t.success?(ew(!1),ey([]),eq(),alert(`Successfully deleted ${t.data.deletedCount} order(s)`)):alert(t.message||"Failed to delete orders")}catch(e){console.error("Error bulk deleting orders:",e),alert("Network error. Please try again.")}finally{ev(!1)}},eU=e=>{eI(e),eD(""),eT(!0)},eE=async()=>{if(eR){ek(!0);try{let e=localStorage.getItem("adminToken");if(!e)return void alert("Please login again");let s=await fetch(`${k}/api/admin/orders/${eR._id}/return/accept`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify({adminNotes:eB.trim()||void 0})}),t=await s.json();t.success?(eT(!1),eI(null),eD(""),eq(),alert("Return request accepted successfully")):alert(t.message||"Failed to accept return request")}catch(e){console.error("Error accepting return request:",e),alert("Network error. Please try again.")}finally{ek(!1)}}},ez=async()=>{if(eR){if(!eB.trim())return void alert("Please provide a reason for denying the return request");ek(!0);try{let e=localStorage.getItem("adminToken");if(!e)return void alert("Please login again");let s=await fetch(`${k}/api/admin/orders/${eR._id}/return/deny`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify({adminNotes:eB.trim()})}),t=await s.json();t.success?(eT(!1),eI(null),eD(""),eq(),alert("Return request denied successfully")):alert(t.message||"Failed to deny return request")}catch(e){console.error("Error denying return request:",e),alert("Network error. Please try again.")}finally{ek(!1)}}},eH=e=>{ei(e),ep({status:e.status}),er(!0)},eJ=e=>"object"==typeof e.customerId&&null!==e.customerId?{name:e.customerId.name||"N/A",mobile:e.customerId.mobile||"N/A"}:{name:"N/A",mobile:"N/A"},eW=e=>"object"==typeof e.vendorId&&null!==e.vendorId?e.vendorId:null,eK=async()=>{try{ef(!0);let e=localStorage.getItem("adminToken");if(!e)return void alert("Please login to export orders");let s=new URLSearchParams({page:"1",limit:"10000",...O&&{search:O},..."all"!==M&&{status:M},..."all"!==E&&{paymentMethod:E},..."all"!==H&&{paymentStatus:H},..."all"!==W&&{vendorId:W},..."all"!==Q&&{assignmentMode:Q}}),t=await fetch(`${k}/api/admin/orders?${s}`,{headers:{Authorization:`Bearer ${e}`}});if(!t.ok)throw Error("Failed to fetch orders for export");let a=await t.json();if(!a.success||!a.data)throw Error("No orders data available");let r=a.data.map(e=>{let s=eJ(e),t=eW(e),a="object"==typeof e.shippingAddress&&null!==e.shippingAddress?e.shippingAddress:null,r=e.items.map(e=>`${e.name} (${e.brand})`).join("; "),n=e.items.map(e=>`${e.name} (${e.brand}) - Qty: ${e.quantity} - ₹${e.price}`).join("; "),l=e.items.reduce((e,s)=>e+s.quantity,0);return[e.orderNumber||"",new Date(e.createdAt).toLocaleDateString("en-IN"),s.name||"",s.mobile||"","object"==typeof e.customerId&&null!==e.customerId&&e.customerId.email||"",t?.name||"Unassigned",t?.phone||"",e.assignmentMode?"assigned-by-admin"===e.assignmentMode?"By Admin":"By Vendor":"",r,n,l.toString(),`₹${e.subtotal.toLocaleString()}`,`₹${e.shipping.toLocaleString()}`,`₹${e.total.toLocaleString()}`,e.paymentMethod.toUpperCase(),D(e.paymentStatus),D(e.status),e.awbNumber||"",P(e.dtdcStatus),_(e.refundStatus),e.refundTransactionId||"",a?`${a.address1||""}`:"",a?.city||"",a?.state||"",a?.postcode||"",a?.phone||""]}),n=["Order Number,Order Date,Customer Name,Customer Mobile,Customer Email,Vendor Name,Vendor Phone,Assignment Mode,Items,Item Details,Quantity,Subtotal,Shipping,Total,Payment Method,Payment Status,Order Status,AWB Number,DTDC Status,Refund Status,Refund Transaction ID,Shipping Address,City,State,Postcode,Phone",...r.map(e=>e.map(e=>`"${String(e).replace(/"/g,'""')}"`).join(","))].join("\n"),l=new Blob([n],{type:"text/csv;charset=utf-8;"}),d=window.URL.createObjectURL(l),i=document.createElement("a"),c=new Date().toISOString().split("T")[0];i.href=d,i.download=`orders_export_${c}.csv`,document.body.appendChild(i),i.click(),window.URL.revokeObjectURL(d),document.body.removeChild(i)}catch(e){console.error("Error exporting orders:",e),alert("Failed to export orders. Please try again.")}finally{ef(!1)}};return(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-3xl font-bold text-foreground",children:"Orders Management"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground mt-1",children:"View and manage all customer orders"})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(l.Button,{variant:"outline",size:"sm",className:"gap-2 bg-transparent",onClick:eK,disabled:ej,children:ej?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(c.Loader2,{className:"h-4 w-4 animate-spin"}),(0,s.jsx)("span",{className:"hidden sm:inline",children:"Exporting..."})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(N.FileDown,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"hidden sm:inline",children:"Export"})]})}),(0,s.jsxs)(l.Button,{variant:"outline",size:"sm",className:"gap-2 bg-transparent",onClick:eq,children:[(0,s.jsx)(x.Download,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"hidden sm:inline",children:"Refresh"})]})]})]}),(0,s.jsx)(r.Card,{className:"shadow-sm",children:(0,s.jsx)(r.CardContent,{className:"pt-6",children:(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4",children:[(0,s.jsxs)("div",{className:"relative flex-1",children:[(0,s.jsx)(o.Search,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),(0,s.jsx)(n.Input,{placeholder:"Search by Order ID, Customer Contact, Product Name...",className:"pl-10",value:O,onChange:e=>F(e.target.value),onKeyDown:e=>{"Enter"===e.key&&eP()}})]}),(0,s.jsxs)(l.Button,{onClick:eP,className:"sm:w-auto",children:[(0,s.jsx)(o.Search,{className:"h-4 w-4 mr-2"}),"Search"]}),(0,s.jsxs)(i.Select,{value:M,onValueChange:U,children:[(0,s.jsx)(i.SelectTrigger,{className:"w-full sm:w-[180px]",children:(0,s.jsx)(i.SelectValue,{placeholder:"Status"})}),(0,s.jsxs)(i.SelectContent,{children:[(0,s.jsx)(i.SelectItem,{value:"all",children:"All Status"}),(0,s.jsx)(i.SelectItem,{value:"pending",children:"Pending"}),(0,s.jsx)(i.SelectItem,{value:"confirmed",children:"Confirmed"}),(0,s.jsx)(i.SelectItem,{value:"processing",children:"Processing"}),(0,s.jsx)(i.SelectItem,{value:"shipped",children:"Shipped"}),(0,s.jsx)(i.SelectItem,{value:"delivered",children:"Delivered"}),(0,s.jsx)(i.SelectItem,{value:"cancelled",children:"Cancelled"})]})]}),(0,s.jsxs)(i.Select,{value:E,onValueChange:z,children:[(0,s.jsx)(i.SelectTrigger,{className:"w-full sm:w-[180px]",children:(0,s.jsx)(i.SelectValue,{placeholder:"Payment Type"})}),(0,s.jsxs)(i.SelectContent,{children:[(0,s.jsx)(i.SelectItem,{value:"all",children:"All Payments"}),(0,s.jsx)(i.SelectItem,{value:"cod",children:"COD"}),(0,s.jsx)(i.SelectItem,{value:"online",children:"Online"}),(0,s.jsx)(i.SelectItem,{value:"wallet",children:"Wallet"})]})]}),(0,s.jsxs)(i.Select,{value:H,onValueChange:J,children:[(0,s.jsx)(i.SelectTrigger,{className:"w-full sm:w-[180px]",children:(0,s.jsx)(i.SelectValue,{placeholder:"Payment Status"})}),(0,s.jsxs)(i.SelectContent,{children:[(0,s.jsx)(i.SelectItem,{value:"all",children:"All Payment Status"}),(0,s.jsx)(i.SelectItem,{value:"pending",children:"Pending"}),(0,s.jsx)(i.SelectItem,{value:"paid",children:"Paid"}),(0,s.jsx)(i.SelectItem,{value:"failed",children:"Failed"}),(0,s.jsx)(i.SelectItem,{value:"refunded",children:"Refunded"})]})]}),(0,s.jsxs)(i.Select,{value:W,onValueChange:K,children:[(0,s.jsx)(i.SelectTrigger,{className:"w-full sm:w-[180px]",children:(0,s.jsx)(i.SelectValue,{placeholder:"Vendor"})}),(0,s.jsxs)(i.SelectContent,{children:[(0,s.jsx)(i.SelectItem,{value:"all",children:"All Vendors"}),(0,s.jsx)(i.SelectItem,{value:"unassigned",children:"Unassigned"}),ec.map(e=>(0,s.jsx)(i.SelectItem,{value:e._id,children:e.name},e._id))]})]}),(0,s.jsxs)(i.Select,{value:Q,onValueChange:X,children:[(0,s.jsx)(i.SelectTrigger,{className:"w-full sm:w-[180px]",children:(0,s.jsx)(i.SelectValue,{placeholder:"Assignment"})}),(0,s.jsxs)(i.SelectContent,{children:[(0,s.jsx)(i.SelectItem,{value:"all",children:"All Modes"}),(0,s.jsx)(i.SelectItem,{value:"assigned-by-admin",children:"By Admin"}),(0,s.jsx)(i.SelectItem,{value:"accepted-by-vendor",children:"By Vendor"})]})]})]})})}),(0,s.jsxs)(r.Card,{className:"shadow-md border-t-4 border-t-primary",children:[(0,s.jsx)(r.CardHeader,{className:"bg-gradient-to-r from-primary/5 to-accent/5",children:(0,s.jsxs)(r.CardTitle,{className:"text-lg",children:["All Orders (",Z.total,") - Page ",Z.page," of ",Z.pages]})}),(0,s.jsx)(r.CardContent,{className:"p-0",children:L?(0,s.jsx)("div",{className:"flex justify-center items-center py-12",children:(0,s.jsx)(c.Loader2,{className:"h-8 w-8 animate-spin text-primary"})}):0===e.length?(0,s.jsx)("div",{className:"text-center py-12",children:(0,s.jsx)("p",{className:"text-muted-foreground",children:"No orders found"})}):(0,s.jsxs)(s.Fragment,{children:[!L&&e.length>0&&(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4 p-4 bg-muted/50 border-b",children:[(0,s.jsx)("div",{className:"flex items-center gap-4",children:(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)(C.Checkbox,{id:"select-all",checked:eN.length===e.length&&e.length>0,onCheckedChange:eF}),(0,s.jsxs)(R.Label,{htmlFor:"select-all",className:"text-sm font-medium cursor-pointer",children:["Select All (",eN.length," selected)"]})]})}),(0,s.jsx)("div",{className:"flex gap-2",children:(0,s.jsx)(l.Button,{variant:"destructive",onClick:()=>ew(!0),disabled:0===eN.length||eb,className:"gap-2",children:eb?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(c.Loader2,{className:"h-4 w-4 animate-spin"}),"Deleting..."]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(y.Trash2,{className:"h-4 w-4"}),"Bulk Delete (",eN.length,")"]})})})]}),(0,s.jsx)("div",{className:"hidden lg:block overflow-x-auto",children:(0,s.jsxs)(w.Table,{children:[(0,s.jsx)(w.TableHeader,{children:(0,s.jsxs)(w.TableRow,{className:"bg-muted/50",children:[(0,s.jsx)(w.TableHead,{className:"font-semibold w-12",children:(0,s.jsx)(C.Checkbox,{checked:eN.length===e.length&&e.length>0,onCheckedChange:eF})}),(0,s.jsx)(w.TableHead,{className:"font-semibold",children:"Order Number"}),(0,s.jsx)(w.TableHead,{className:"font-semibold",children:"Customer"}),(0,s.jsx)(w.TableHead,{className:"font-semibold",children:"Vendor"}),(0,s.jsx)(w.TableHead,{className:"font-semibold",children:"Assignment"}),(0,s.jsx)(w.TableHead,{className:"font-semibold",children:"Items"}),(0,s.jsx)(w.TableHead,{className:"font-semibold",children:"Payment"}),(0,s.jsx)(w.TableHead,{className:"font-semibold",children:"Status"}),(0,s.jsx)(w.TableHead,{className:"font-semibold",children:"DTDC Status"}),(0,s.jsx)(w.TableHead,{className:"font-semibold",children:"Refund Status"}),(0,s.jsx)(w.TableHead,{className:"font-semibold",children:"Total"}),(0,s.jsx)(w.TableHead,{className:"font-semibold",children:"Date"}),(0,s.jsx)(w.TableHead,{className:"font-semibold text-right",children:"Actions"})]})}),(0,s.jsx)(w.TableBody,{children:e.map(e=>{let t=eJ(e),r=eW(e),n=e.items.reduce((e,s)=>e+s.quantity,0);return(0,s.jsxs)(w.TableRow,{className:"hover:bg-muted/30 transition-colors",children:[(0,s.jsx)(w.TableCell,{children:(0,s.jsx)(C.Checkbox,{checked:eN.includes(e._id),onCheckedChange:()=>eO(e._id)})}),(0,s.jsx)(w.TableCell,{className:"font-medium text-primary",children:(0,s.jsx)(a.default,{href:`/admin/orders/${e._id}`,className:"hover:underline",children:e.orderNumber})}),(0,s.jsx)(w.TableCell,{className:"text-sm",children:(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"font-medium",children:t.name}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:t.mobile})]})}),(0,s.jsx)(w.TableCell,{className:"text-sm",children:r?(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"font-medium",children:r.name}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:r.phone}),r.address&&(0,s.jsxs)("p",{className:"text-xs text-muted-foreground",children:[r.address.city,", ",r.address.state]})]}):(0,s.jsx)(d.Badge,{variant:"outline",className:"text-xs",children:"Unassigned"})}),(0,s.jsx)(w.TableCell,{className:"text-xs",children:e.assignmentMode?(0,s.jsx)(d.Badge,{variant:"assigned-by-admin"===e.assignmentMode?"secondary":"default",className:"text-[10px] px-1.5 py-0.5",title:"assigned-by-admin"===e.assignmentMode?"Assigned by Admin":"Accepted by Vendor",children:"assigned-by-admin"===e.assignmentMode?"By Admin":"By Vendor"}):(0,s.jsx)("span",{className:"text-muted-foreground",children:"-"})}),(0,s.jsx)(w.TableCell,{className:"text-sm",children:(0,s.jsxs)("div",{children:[(0,s.jsxs)("p",{className:"font-medium",children:[n," item(s)"]}),(0,s.jsxs)("p",{className:"text-xs text-muted-foreground",children:[e.items[0]?.name||"N/A",e.items.length>1&&` +${e.items.length-1} more`]})]})}),(0,s.jsx)(w.TableCell,{children:(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsx)(d.Badge,{variant:"cod"===e.paymentMethod?"secondary":"default",className:"text-xs",children:e.paymentMethod.toUpperCase()}),(0,s.jsx)("br",{}),(0,s.jsx)(d.Badge,{variant:"paid"===e.paymentStatus?"default":"failed"===e.paymentStatus?"destructive":"secondary",className:"text-xs",children:D(e.paymentStatus)})]})}),(0,s.jsx)(w.TableCell,{children:(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsx)(d.Badge,{asChild:!0,className:`${B(e.status)} cursor-pointer`,title:"View order details",children:(0,s.jsx)(a.default,{href:`/admin/orders/${e._id}`,children:D(e.status)})}),e.returnRequest&&e.returnRequest.type&&(0,s.jsxs)(d.Badge,{variant:"pending"===e.returnRequest.type?"secondary":"accepted"===e.returnRequest.type?"default":"destructive",className:"text-xs ml-1",children:[(0,s.jsx)(b.RotateCcw,{className:"h-3 w-3 mr-1 inline"}),"Return ",e.returnRequest.type]})]})}),(0,s.jsx)(w.TableCell,{children:e.awbNumber?(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsx)(d.Badge,{className:q(e.dtdcStatus),children:P(e.dtdcStatus)}),(0,s.jsxs)("p",{className:"text-xs text-muted-foreground mt-1",children:["AWB: ",e.awbNumber]})]}):(0,s.jsx)("span",{className:"text-muted-foreground text-sm",children:"-"})}),(0,s.jsx)(w.TableCell,{children:e.refundStatus?(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsx)(d.Badge,{className:$(e.refundStatus),children:_(e.refundStatus)}),e.refundTransactionId&&(0,s.jsxs)("p",{className:"text-xs text-muted-foreground mt-1",children:["ID: ",e.refundTransactionId.slice(0,12),"..."]})]}):(0,s.jsx)("span",{className:"text-muted-foreground text-sm",children:"-"})}),(0,s.jsxs)(w.TableCell,{className:"font-semibold",children:["₹",e.total.toLocaleString()]}),(0,s.jsx)(w.TableCell,{className:"text-sm text-muted-foreground",children:new Date(e.createdAt).toLocaleDateString("en-IN",{year:"numeric",month:"short",day:"numeric"})}),(0,s.jsx)(w.TableCell,{className:"text-right",children:(0,s.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,s.jsx)(a.default,{href:`/admin/orders/${e._id}`,children:(0,s.jsxs)(l.Button,{variant:"ghost",size:"sm",className:"gap-2",children:[(0,s.jsx)(m.Eye,{className:"h-4 w-4"}),"View"]})}),(0,s.jsxs)(l.Button,{variant:"ghost",size:"sm",className:"gap-2",onClick:()=>eV(e),title:"Assign Vendor",children:[(0,s.jsx)(j,{className:"h-4 w-4"}),"Vendor"]}),(0,s.jsxs)(l.Button,{variant:"ghost",size:"sm",className:"gap-2",onClick:()=>eH(e),children:[(0,s.jsx)(h,{className:"h-4 w-4"}),"Edit"]}),e.returnRequest&&"pending"===e.returnRequest.type&&(0,s.jsxs)(l.Button,{variant:"ghost",size:"sm",className:"gap-2 text-orange-600 hover:text-orange-700",onClick:()=>eU(e),title:"Review Return Request",children:[(0,s.jsx)(b.RotateCcw,{className:"h-4 w-4"}),"Return"]})]})})]},e._id)})})]})}),(0,s.jsx)("div",{className:"lg:hidden divide-y divide-border",children:e.map(e=>{let t=eJ(e),r=eW(e),n=e.items.reduce((e,s)=>e+s.quantity,0);return(0,s.jsx)("div",{className:"p-4 hover:bg-muted/30 transition-colors",children:(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(C.Checkbox,{checked:eN.includes(e._id),onCheckedChange:()=>eO(e._id)}),(0,s.jsx)(a.default,{href:`/admin/orders/${e._id}`,children:(0,s.jsx)("h3",{className:"font-semibold text-primary hover:underline",children:e.orderNumber})})]}),(0,s.jsx)(d.Badge,{className:B(e.status),children:D(e.status)})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-muted-foreground",children:"Customer:"}),(0,s.jsx)("p",{className:"font-medium",children:t.name}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:t.mobile})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-muted-foreground",children:"Vendor:"}),r?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("p",{className:"font-medium",children:r.name}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:r.phone}),e.assignmentMode&&(0,s.jsx)(d.Badge,{variant:"assigned-by-admin"===e.assignmentMode?"secondary":"default",className:"text-[10px] mt-1 px-1.5 py-0",title:"assigned-by-admin"===e.assignmentMode?"Assigned by Admin":"Accepted by Vendor",children:"assigned-by-admin"===e.assignmentMode?"By Admin":"By Vendor"})]}):(0,s.jsx)(d.Badge,{variant:"outline",className:"text-xs mt-1",children:"Unassigned"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-muted-foreground",children:"Items:"}),(0,s.jsxs)("p",{className:"font-medium",children:[n," item(s)"]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-muted-foreground",children:"Payment:"}),(0,s.jsx)("p",{className:"font-medium",children:e.paymentMethod.toUpperCase()}),(0,s.jsx)(d.Badge,{variant:"paid"===e.paymentStatus?"default":"failed"===e.paymentStatus?"destructive":"secondary",className:"text-xs mt-1",children:D(e.paymentStatus)})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-muted-foreground",children:"Total:"}),(0,s.jsxs)("p",{className:"font-semibold text-green-600",children:["₹",e.total.toLocaleString()]})]}),e.awbNumber&&(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-muted-foreground",children:"DTDC Status:"}),(0,s.jsxs)("div",{className:"mt-1 space-y-1",children:[(0,s.jsx)(d.Badge,{className:q(e.dtdcStatus),children:P(e.dtdcStatus)}),(0,s.jsxs)("p",{className:"text-xs text-muted-foreground mt-1",children:["AWB: ",e.awbNumber]})]})]}),e.refundStatus&&(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-muted-foreground",children:"Refund Status:"}),(0,s.jsxs)("div",{className:"mt-1 space-y-1",children:[(0,s.jsx)(d.Badge,{className:$(e.refundStatus),children:_(e.refundStatus)}),e.refundTransactionId&&(0,s.jsxs)("p",{className:"text-xs text-muted-foreground mt-1",children:["ID: ",e.refundTransactionId.slice(0,12),"..."]})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-muted-foreground",children:"Status:"}),(0,s.jsxs)("div",{className:"mt-1 space-y-1",children:[(0,s.jsx)(d.Badge,{asChild:!0,className:`${B(e.status)} cursor-pointer`,title:"View order details",children:(0,s.jsx)(a.default,{href:`/admin/orders/${e._id}`,children:D(e.status)})}),e.returnRequest&&e.returnRequest.type&&(0,s.jsxs)(d.Badge,{variant:"pending"===e.returnRequest.type?"secondary":"accepted"===e.returnRequest.type?"default":"destructive",className:"text-xs ml-1",children:[(0,s.jsx)(b.RotateCcw,{className:"h-3 w-3 mr-1 inline"}),"Return ",e.returnRequest.type]})]})]})]}),(0,s.jsxs)("div",{className:"flex justify-end gap-2 pt-2 border-t",children:[(0,s.jsx)(a.default,{href:`/admin/orders/${e._id}`,children:(0,s.jsxs)(l.Button,{variant:"outline",size:"sm",className:"gap-2 bg-transparent",children:[(0,s.jsx)(m.Eye,{className:"h-4 w-4"}),"View"]})}),(0,s.jsxs)(l.Button,{variant:"outline",size:"sm",className:"gap-2 bg-transparent",onClick:()=>eV(e),children:[(0,s.jsx)(j,{className:"h-4 w-4"}),"Vendor"]}),(0,s.jsxs)(l.Button,{variant:"outline",size:"sm",className:"gap-2 bg-transparent",onClick:()=>eH(e),children:[(0,s.jsx)(h,{className:"h-4 w-4"}),"Edit"]}),e.returnRequest&&"pending"===e.returnRequest.type&&(0,s.jsxs)(l.Button,{variant:"outline",size:"sm",className:"gap-2 bg-transparent text-orange-600 hover:text-orange-700",onClick:()=>eU(e),children:[(0,s.jsx)(b.RotateCcw,{className:"h-4 w-4"}),"Return"]})]})]})},e._id)})})]})})]}),Z.pages>1&&(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"text-sm text-muted-foreground",children:["Showing ",(Z.page-1)*Z.limit+1," to"," ",Math.min(Z.page*Z.limit,Z.total)," of ",Z.total," orders"]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsxs)(l.Button,{variant:"outline",size:"sm",onClick:()=>Y(e=>Math.max(1,e-1)),disabled:1===G||L,children:[(0,s.jsx)(g.ChevronLeft,{className:"h-4 w-4"}),"Previous"]}),(0,s.jsxs)("div",{className:"text-sm",children:["Page ",Z.page," of ",Z.pages]}),(0,s.jsxs)(l.Button,{variant:"outline",size:"sm",onClick:()=>Y(e=>Math.min(Z.pages,e+1)),disabled:G===Z.pages||L,children:["Next",(0,s.jsx)(p.ChevronRight,{className:"h-4 w-4"})]})]})]}),(0,s.jsx)(T.Dialog,{open:ea,onOpenChange:er,children:(0,s.jsxs)(T.DialogContent,{children:[(0,s.jsxs)(T.DialogHeader,{children:[(0,s.jsx)(T.DialogTitle,{children:"Update Order"}),(0,s.jsx)(T.DialogDescription,{children:"Update order status and payment information"})]}),ed&&(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(R.Label,{children:"Order Number"}),(0,s.jsx)("p",{className:"font-semibold",children:ed.orderNumber})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(R.Label,{htmlFor:"status",children:"Order Status"}),(0,s.jsxs)(i.Select,{value:eg.status,onValueChange:e=>ep({...eg,status:e}),children:[(0,s.jsx)(i.SelectTrigger,{children:(0,s.jsx)(i.SelectValue,{})}),(0,s.jsxs)(i.SelectContent,{children:[(0,s.jsx)(i.SelectItem,{value:"pending",children:"Pending"}),(0,s.jsx)(i.SelectItem,{value:"confirmed",children:"Confirmed"}),(0,s.jsx)(i.SelectItem,{value:"processing",children:"Processing"}),(0,s.jsx)(i.SelectItem,{value:"shipped",children:"Shipped"}),(0,s.jsx)(i.SelectItem,{value:"delivered",children:"Delivered"}),(0,s.jsx)(i.SelectItem,{value:"cancelled",children:"Cancelled"}),(0,s.jsx)(i.SelectItem,{value:"return_requested",children:"Return Requested"}),(0,s.jsx)(i.SelectItem,{value:"return_accepted",children:"Return Accepted"}),(0,s.jsx)(i.SelectItem,{value:"return_rejected",children:"Return Rejected"}),(0,s.jsx)(i.SelectItem,{value:"return_picked_up",children:"Return Picked Up"})]})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(R.Label,{htmlFor:"paymentStatus",children:"Payment Status"}),(0,s.jsx)("p",{className:"font-semibold mt-1",children:D(ed.paymentStatus)}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"Payment status is updated automatically and cannot be changed here."})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(R.Label,{htmlFor:"paymentMethod",children:"Payment Method"}),(0,s.jsx)("p",{className:"font-semibold mt-1",children:ed.paymentMethod.toUpperCase()}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"Payment method is set when the order is created and cannot be changed here."})]}),(0,s.jsxs)("div",{className:"flex gap-2 pt-4",children:[(0,s.jsx)(l.Button,{onClick:e_,disabled:es===ed._id,className:"flex-1",children:es===ed._id?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(c.Loader2,{className:"h-4 w-4 mr-2 animate-spin"}),"Updating..."]}):"Update Order"}),(0,s.jsx)(l.Button,{variant:"outline",onClick:()=>er(!1),children:"Cancel"})]})]})]})}),(0,s.jsx)(T.Dialog,{open:en,onOpenChange:el,children:(0,s.jsxs)(T.DialogContent,{children:[(0,s.jsxs)(T.DialogHeader,{children:[(0,s.jsx)(T.DialogTitle,{children:"Assign Vendor to Order"}),(0,s.jsx)(T.DialogDescription,{children:"Select a vendor to assign to this order"})]}),ed&&(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(R.Label,{children:"Order Number"}),(0,s.jsx)("p",{className:"font-semibold",children:ed.orderNumber})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(R.Label,{htmlFor:"vendor",children:"Select Vendor"}),em?(0,s.jsx)("div",{className:"flex items-center justify-center py-4",children:(0,s.jsx)(c.Loader2,{className:"h-4 w-4 animate-spin text-primary"})}):(0,s.jsxs)(i.Select,{value:eh,onValueChange:ex,children:[(0,s.jsx)(i.SelectTrigger,{children:(0,s.jsx)(i.SelectValue,{placeholder:"Select a vendor"})}),(0,s.jsxs)(i.SelectContent,{children:[(0,s.jsx)(i.SelectItem,{value:"none",children:"Unassign (No Vendor)"}),ec.map(e=>(0,s.jsx)(i.SelectItem,{value:e._id,children:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(f.Store,{className:"h-4 w-4"}),(0,s.jsx)("span",{children:e.name}),e.address&&(0,s.jsxs)("span",{className:"text-xs text-muted-foreground",children:["- ",e.address.city,", ",e.address.state]})]})},e._id))]})]})]}),0===ec.length&&!em&&(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"No approved vendors available"}),(0,s.jsxs)("div",{className:"flex gap-2 pt-4",children:[(0,s.jsx)(l.Button,{onClick:eL,disabled:es===ed._id||em,className:"flex-1",children:es===ed._id?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(c.Loader2,{className:"h-4 w-4 mr-2 animate-spin"}),"Assigning..."]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(j,{className:"h-4 w-4 mr-2"}),"none"===eh?"Unassign Vendor":"Assign Vendor"]})}),(0,s.jsx)(l.Button,{variant:"outline",onClick:()=>el(!1),children:"Cancel"})]})]})]})}),(0,s.jsx)(T.Dialog,{open:eS,onOpenChange:ew,children:(0,s.jsxs)(T.DialogContent,{children:[(0,s.jsxs)(T.DialogHeader,{children:[(0,s.jsx)(T.DialogTitle,{children:"Confirm Bulk Delete"}),(0,s.jsxs)(T.DialogDescription,{children:["This will permanently delete ",eN.length," order(s) and remove them from records. This action cannot be undone."]})]}),(0,s.jsxs)("div",{className:"flex gap-2 pt-4",children:[(0,s.jsx)(l.Button,{variant:"destructive",onClick:eM,disabled:eb||0===eN.length,className:"flex-1",children:eb?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(c.Loader2,{className:"h-4 w-4 mr-2 animate-spin"}),"Deleting..."]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(y.Trash2,{className:"h-4 w-4 mr-2"}),"Delete ",eN.length," Order(s)"]})}),(0,s.jsx)(l.Button,{variant:"outline",onClick:()=>ew(!1),disabled:eb,children:"Cancel"})]})]})}),(0,s.jsx)(T.Dialog,{open:eC,onOpenChange:eT,children:(0,s.jsxs)(T.DialogContent,{className:"max-w-2xl",children:[(0,s.jsxs)(T.DialogHeader,{children:[(0,s.jsxs)(T.DialogTitle,{className:"flex items-center gap-2",children:[(0,s.jsx)(b.RotateCcw,{className:"h-5 w-5"}),"Review Return Request"]}),(0,s.jsx)(T.DialogDescription,{children:"Review and accept or deny the return request for this order"})]}),eR&&eR.returnRequest&&(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(R.Label,{children:"Order Number"}),(0,s.jsx)("p",{className:"font-semibold",children:eR.orderNumber})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(R.Label,{children:"Customer Return Reason"}),(0,s.jsx)(A.Alert,{className:"mt-2",children:(0,s.jsx)(A.AlertDescription,{children:eR.returnRequest.reason})})]}),eR.returnRequest.requestedAt&&(0,s.jsxs)("div",{children:[(0,s.jsx)(R.Label,{children:"Requested At"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:new Date(eR.returnRequest.requestedAt).toLocaleString("en-IN")})]}),eR.returnRequest.attachments&&eR.returnRequest.attachments.length>0&&(0,s.jsxs)("div",{children:[(0,s.jsx)(R.Label,{children:"Customer Uploads"}),(0,s.jsx)("ul",{className:"mt-2 space-y-1 text-sm",children:eR.returnRequest.attachments.map((e,t)=>{var a;return(0,s.jsxs)("li",{className:"flex items-center justify-between gap-2",children:[(0,s.jsx)("a",{href:(a=e.url)?a.startsWith("http")?a:`${k}${a}`:"",target:"_blank",rel:"noopener noreferrer",className:"text-primary underline",children:e.originalName||e.url?.split("/").pop()}),(0,s.jsxs)("span",{className:"text-xs text-muted-foreground",children:[(e.mimeType?.split("/")?.[0]||"file").toUpperCase()," ",(e=>{if(!e)return"";let s=e/1024/1024;return s>=1?`${s.toFixed(1)} MB`:`${(e/1024).toFixed(0)} KB`})(e.size)]})]},`${e.url}-${t}`)})})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)(R.Label,{htmlFor:"adminNotes",children:["Admin Notes ","pending"===eR.returnRequest.type&&"(Required for denial)"]}),(0,s.jsx)(I.Textarea,{id:"adminNotes",placeholder:"Add notes about your decision (required if denying)...",value:eB,onChange:e=>eD(e.target.value),rows:4,className:"mt-2"})]}),"pending"===eR.returnRequest.type&&(0,s.jsxs)("div",{className:"flex gap-2 pt-4 border-t",children:[(0,s.jsx)(l.Button,{onClick:eE,disabled:eA,className:"flex-1 bg-green-600 hover:bg-green-700",children:eA?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(c.Loader2,{className:"h-4 w-4 mr-2 animate-spin"}),"Processing..."]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(v.CheckCircle,{className:"h-4 w-4 mr-2"}),"Accept Return"]})}),(0,s.jsx)(l.Button,{onClick:ez,disabled:eA,variant:"destructive",className:"flex-1",children:eA?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(c.Loader2,{className:"h-4 w-4 mr-2 animate-spin"}),"Processing..."]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(S.XCircle,{className:"h-4 w-4 mr-2"}),"Deny Return"]})}),(0,s.jsx)(l.Button,{variant:"outline",onClick:()=>{eT(!1),eI(null),eD("")},disabled:eA,children:"Cancel"})]}),"pending"!==eR.returnRequest.type&&(0,s.jsxs)("div",{className:"pt-4 border-t",children:[(0,s.jsx)(A.Alert,{variant:"accepted"===eR.returnRequest.type?"default":"destructive",children:(0,s.jsxs)(A.AlertDescription,{children:[(0,s.jsxs)("div",{className:"font-semibold mb-1",children:["Status: ","accepted"===eR.returnRequest.type?"Accepted":"Denied"]}),eR.returnRequest.adminNotes&&(0,s.jsxs)("div",{className:"mt-1",children:[(0,s.jsx)("span",{className:"font-medium",children:"Admin Notes:"})," ",eR.returnRequest.adminNotes]}),eR.returnRequest.reviewedAt&&(0,s.jsxs)("div",{className:"mt-1 text-sm text-muted-foreground",children:["Reviewed: ",new Date(eR.returnRequest.reviewedAt).toLocaleString("en-IN")]}),"accepted"===eR.returnRequest.type&&eR.returnRequest.refundStatus&&(0,s.jsxs)("div",{className:"mt-1",children:[(0,s.jsx)("span",{className:"font-medium",children:"Refund Status:"})," ",eR.returnRequest.refundStatus]})]})}),(0,s.jsx)(l.Button,{variant:"outline",onClick:()=>{eT(!1),eI(null),eD("")},className:"mt-4 w-full",children:"Close"})]})]})]})})]})}e.s(["AdminOrdersList",()=>L],31439)}]);